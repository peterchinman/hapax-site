<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <title>Hapax Legomena Finder</title>

   <meta name="description" content="Find Hapax Legomena from the safety of your browser.">
   <meta property="og:image" content="[[Insert Absolute Path]]">

   <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <header>
        <hr class="
        top-bar">
        <div class="title">Hapax
Legomenon
Finder</div>
        <div class="description">
            <p>A <em>hapax legomenon</em> (abbreviated to <em>hapax</em>, pl. <em>hapax legomena</em>) is a word that's used only once in a body of text. In the translation of dead languages, hapaxes are the prickly outliersâ€”words that come with only a single context from which to infer their meaning.</p>
            <p>I'm interested in these the prickly points. The silhouette of a vocabulary.</p>
            <p><a href="https://peterchinman.substack.com/p/finding-hapaxes">Read about coding this project.</a></p>
        </div>
        <hr class="bottom-bar">
    </header>
    <main>
        <section class="examples">
            <h1 class="assertive">Explore hapaxes from these texts:</h1>
            
            <!-- TODO figure out how to get this links to work
                        probably onclick="load_moby_dick"
                        or: when it clicks do a php include -->
            
            <ul>
                <li>
                    <a href="">Moby Dick</a>
                </li>
                <li>
                    <a href="">Dickinson</a>
                </li>
                <li>
                    <a href="">The Bible</a>
                </li>
                <li>
                    <a href="">Shakespeare</a>
                </li>
                <li>
                    <a href="">Proust</a>
                </li>
                <li>
                    <a href="">Joyce</a>
                </li>
                <li>
                    <a href="">Homer</a>
                </li>
                <li>
                    <a href="">Nietzsche</a>
                </li>
                <li>
                    <a href="">Milton</a>
                </li>
            </ul>
        </section>
        <section class="upload">
            <h1 class="assertive">Or upload your own:</h1>
            <div class="buttons">
                <div class="select-text-button button">
                    <button id="select-text" class="primary" onclick="fileInput.click()">Select Text</button>
                    <input class="button-label" type="file" id="fileInput">
                </div>
                <!-- <input type="number" value="1" id="depthInput" placeholder="Depth" /> -->
                <div class="find-hapaxes-button button">
                    <button id="find-hapaxes" class="highlight" onclick="processFile()">Find Hapaxes</button>
                    <label class="button-label" for="find-hapaxes">Note: currently can only process plaintext files</label>
                </div>
            </div>
        </section>
    </main>

    <section class="hapax-output">
        <div class="hapax-card">
            <div class="top-bar">
                <h1 class="assertive" id="status">Waiting & Ready...</h1>
                <div class="buttons">
                    <button id="export" class="primary" onclick="exportHapax()" disabled>Export</button>
                    <button id="clear" class="quiet" onclick="clearHapax()" disabled>Clear</button>
                </div>
            </div>
            <!-- TODO figure out how to get this pre instead as a ul, each word as li -->
            <pre id="output">aaron
abandon
abandoned
abandoning
abandons
abort
abrosia
absolutelyabsolutelyabsolutely
abstracts
abudive
abysshit
acapella
accident
accidentally
acknowledge
acknowledgement
acro
acting
action
activity
ad
addict
addin
adjoining
adjudicate
admit
admits
adromischus
adult
advanced
advantage
advertised
advisor
aerial
affectionate
affectionately
affective
aftermath
afterwards
agates
aged
ages
aggressive
aggressively
ago
agree
ahead
aids
aim
aims
airvin
aisle
ajar
aka
akomplice
al
alas
alerting
alerts
alessi
alice
alive
allergic
allison
allows
allyship
aloes
alpha
alternates
altogether
amateur
amazon
ambushed
amelia
america
among
amount
amplified
amused
amusement
anabda
analysis
anderson
ankle
ankles
annie
announced
annoying
anonymity
answers
ants
anxious
anymore
aoe
apartment
ape
apologize
apology
apparent
appearance
appeared
apple
appreciate
appreciated
appreciative
appropriate
arcade
archeological
architecture
ardella
arizona
arm
armed
armrest
arrested
arrives
arriving
artist
artists
ash
ashamed
asians
assemble
assembled
assembly
assertive
asshole
assist
assistance
assistant
assortment
assuming
assure
astronaut
athena
athenian
athletic
atlas
atm
atmosphere
attackers
attacks
attendance
attendees
attracted
audio
austen
austin
avant-garde
avo
avocados
awards
awkwardly
b-ball
backpacking
backs
backup
badger
bags
bail
balances
bald
banana
bang
bangs
baobab
barbara
barbarians
barefoot
barks
barrable
bars
bartering
based
bath
baths
bbq
beaks
bean
beard
bears
beautifully
beds
bedside
befriends
begrudgingly
behavior
belief
bellman
belly
ben
bend
bends
benedict
bewildered
bickering
bigger
bikers
bikes
billboard
binoche
bird
birds
bite
bites
bizarre
blackmail
blacks
blame
blank
blankets
blazing
bleeds
blend
blender
blending
blimps
blockade
blocked
blocks
bludgeon
blurbs
blurring
bolo
bombing
bonded
bones
booth
boots
border
borders
boston
botanical
bother
bothered
boulder
boundaries
bounds
boutique
bowl
boxers
boyish
boyle
branches
branded
braved
breakers
breasts
breath
breintroduxe
brief
briefly
brink
britney
broad
broom
brothers
brotman
brownie
bruises
brushes
brutal
brute
bs
buddy
buffaloes
bugle
bulge
bullets
bullies
bullshit
bunk
bunny
bureaucracy
burgers
buried
burn
burns
burrowing
bury
bushy
businesses
busses
butter
cab
cabbage
cake
california
calling
calm
calms
cambridge
cameron
camouflaged
campaign
campground
campus
canada
candelabra
cane
cannibal
cannibal-eye
cant
capacitate
capitalism
caramel
carbonated
cardboard
cardio
cards
care-takers
careeer
carnevalesque
carpet
carried
cassette
cassie
catching
cats
caudiciform
cayenne
cds
celebrate
celia
centers
ceramic
cereal
ceremony
chain
chairman
chalk
chamber
chana
chances
chanel
changes
chants
chapo
characteristics
charlotte
chase
cheap
cheney
chesleys
chick
childhood
childish
childrides
chill
chillfrst
chilling
china
chinman
chocolates
chorus
church-tree
cigarettes
circle
circling
cirque
claim
claimed
claiming
classmates
cleaned
clearwater
climbed
climbs
clones
cloning
closely
clumps
clung
coagulates
coating
coats
cocain
cocks
cocktail
coconut
coconuts
cohort
collapsing
collar
colleague
colony
color
colorado
colorful
com
combat
comfort
comforted
comforting
commando
commented
commercials
commodity
communicate
community
company
compare
comparing
compelled
competing
competition
completely
complex
compression
computers
comrade
concerned
conditioning
condoms
conference
conflict
confrontational
confusing
congratulates
connects
conner
conor
cons
consequences
consists
constant
constantly
consult
contact
contemporary
content
contest
context
continuity
contours
contraptions
convenience
convent
convincing
conway
cook
cookies
cooking
cooperation
cooperatives
coordinates
corners
corporation
corps
corrected
corridor
corridors
corrupted
corvette
cosmic
costs
costume
couldnt
counting
court
cowboy
coy
crab
crack
cracked
cracks
crap
crashes
crater
crawled
cray
created
credits
cried
cries
crime
criminal
criticized
criticizing
critiques
crocodiles
crossbow
crowded
cruise
crumpled
cry
crystal
ctd
cuddle
cuddled
cuddles
cupcakes
currents
curves
cut-out
cutest
cuts
cutter
cuttings
cw
cyborg
daddy
dagostino
daiya
dakotacarlson
damaging
damn
dancer
dancers
dancing
dane
danger
dangers
darker
darkness
data
daughter
dc
deal
dealer
dean-like
debacle
debusy
decade
decadent
decides
decision
decon
decor
decorator
decorum
dedicated
dedication
deduce
defeat
defeated
defending
defends
defenses
definite
definitely
deflect
dejong
delete
delicious
delight
delineating
delivered
demanded
demands
demise
democracy
demons
demonstrations
denizens
departs
deranged
derrida
descent
describes
deserve
design
despicable
destroy
destroys
detector
determined
deterritotialized
deterritotium
devastate
devouring
diamandis
diapers
die
diesel
diet
difference
dilemma
dinners
dinoaaur
dinosaur
dip
dirty
disable
disabled
disappoint
disarm
disaster
disc
disconnected
discount
discourse
discover
discovered
discovers
discredited
disgusted
disintegrates
dismember
disrespect</pre>
        </div>
    </section>
    
    
    <script>
        // Initialize the WebAssembly module
        var Module = {
            onRuntimeInitialized: function() {
                console.log('WASM loaded');
            }
        };
    </script>

    <script src="hapax.js"></script>

    <script>
        function processFile() {
            const fileInput = document.getElementById('fileInput');
            // const depthInput = document.getElementById('depthInput');
            const output = document.getElementById('output');

            if (fileInput.files.length === 0) {
                output.textContent = 'Please select a file!';
                return;
            }


            const file = fileInput.files[0];
            // disabling depth for now, not actually needed
            // const depth = depthInput.value;
            const depth = 1;

            if (!depth) {
                output.textContent = 'Please enter a depth value!';
                return;
            }

            const reader = new FileReader();

            reader.onload = function(event) {
                const content = event.target.result;

                // Create a virtual filesystem in the browser
                FS.writeFile('input.txt', content);
                FS.open('output.txt', 'w+');

                // Run the WebAssembly module
                Module.callMain(['input.txt', 'output.txt', depth]);

                // Read the output file from the virtual filesystem
                const result = FS.readFile('output.txt', { encoding: 'utf8' });
                output.textContent = result;

                // TODO also set .hapax-output display: grid
                // TODO set focus on .hapax-output?
            };

            reader.readAsText(file);
        }
    </script>
</body>
</html>
